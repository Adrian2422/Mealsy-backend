{"version":3,"sources":["../../src/config/passport.js"],"names":["JWTStrategy","passportJWT","Strategy","ExtractJWT","ExtractJwt","verifyCallback","payload","done","User","findOne","_id","id","then","user","catch","err","config","jwtFromRequest","fromAuthHeaderAsBearerToken","secretOrKey","process","env","JWT_SECRET","passport","use","createStrategy"],"mappings":"2EAAA,oC;AACA,2C;AACA,8C;;AAEA,IAAMA,cAAcC,sBAAYC,QAAhC;AACA,IAAMC,aAAaF,sBAAYG,UAA/B;;AAEA,SAASC,cAAT,CAAwBC,OAAxB,EAAiCC,IAAjC,EAAsC;AACpC,SAAOC,gBAAKC,OAAL,CAAa,EAAEC,KAAKJ,QAAQK,EAAf,EAAb;AACJC,MADI,CACC,gBAAQ;AACZ,WAAOL,KAAK,IAAL,EAAWM,IAAX,CAAP;AACD,GAHI,EAGFC,KAHE,CAGI,eAAO;AACd,WAAOP,KAAKQ,GAAL,CAAP;AACD,GALI,CAAP;AAMD,C;;AAEc,YAAM;AACnB,MAAMC,SAAS;AACbC,oBAAgBd,WAAWe,2BAAX,EADH;AAEbC,iBAAaC,QAAQC,GAAR,CAAYC,UAFZ,EAAf;;AAIAC,qBAASC,GAAT,CAAahB,gBAAKiB,cAAL,EAAb;AACAF,qBAASC,GAAT,CAAa,IAAIxB,WAAJ,CAAgBgB,MAAhB,EAAwBX,cAAxB,CAAb;AACD,C","file":"passport.js","sourcesContent":["import passport from 'passport';\r\nimport passportJWT from 'passport-jwt';\r\nimport User from '../models/users.model';\r\n\r\nconst JWTStrategy = passportJWT.Strategy;\r\nconst ExtractJWT = passportJWT.ExtractJwt;\r\n\r\nfunction verifyCallback(payload, done){\r\n  return User.findOne({ _id: payload.id })\r\n    .then(user => {\r\n      return done(null, user);\r\n    }).catch(err => {\r\n      return done(err);\r\n    })\r\n}\r\n\r\nexport default () => {\r\n  const config = {\r\n    jwtFromRequest: ExtractJWT.fromAuthHeaderAsBearerToken(),\r\n    secretOrKey: process.env.JWT_SECRET\r\n  };\r\n  passport.use(User.createStrategy());\r\n  passport.use(new JWTStrategy(config, verifyCallback));\r\n}"]}